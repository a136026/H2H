H2H-Doc-DBDD-v3.0

**数据库设计说明**

**版本： 3.0**

>   编写： *孟奇一*

>   校对： *孟奇一*

>   审核： *李宁生*

>   批准： *卢延悦*

**2019年7月**

**修订记录**

| **版本号** | **修订时间** | **修订内容**                                            | **提出人** | **审核人**         | **是否通过** |
|------------|--------------|---------------------------------------------------------|------------|--------------------|--------------|
| **1.1**    | **7.2**      | **添加数据表，任务类别**                                | **宋昌**   | **卢延悦**         | **是**       |
| **1.1**    | **7.2**      | **user列表中添加最后登录时间**                          | **宋昌**   | **卢延悦**         | **是**       |
| **1.1**    | **7.2**      | **删除task中非必须属性**                                | **宋昌**   | **卢延悦**         |              |
| **1.2**    | **7.3**      | **修改一些文档错误**                                    | **李宁生** | **李宁生**         | **是**       |
| **1.2**    | **7.3**      | **在task中添加了新的属性 heatValue**                    | **宋昌**   | **李宁生**         | **是**       |
| **1.3**    | **7.3**      | **数据表applicant改名为apply**                          | **陆韬韬** | **李宁生**         | **是**       |
| **1.4**    | **7.5**      | **admin表项添加属性adminNum如果不添加无法进行数据交互** | **李宁生** | **李宁生**         | **是**       |
| **2.0**    | **7.6**      | **添加表项参数param**                                   | **宋昌**   | **李宁生**         | **是**       |
| **2.1**    | **7.9**      | **Message表添加属性showState**                          | **孟奇一** | **李宁生**         | **是**       |
| **3.0**    | **7.11**     | **修改了和项目不符的部分**                              | **李宁生** | **卢延悦、孟奇一** | **是**       |

**审核记录**

| **审核版本号** | **审核时间** | **审核内容**             | **审核问题**           | **审核人**         | **是否通过** |
|----------------|--------------|--------------------------|------------------------|--------------------|--------------|
| **1.1**        | **7.2**      | **数据项是否完善**       | **无**                 | **李宁生**         | **是**       |
| **2.1**        | **7.9**      | **数据项是否与项目匹配** | **部分描述不符合实际** | **卢延悦、孟奇一** | **是**       |
| **3.0**        | **7.11**     | **数据项是否与项目匹配** | **无**                 | **卢延悦、孟奇一** | **是**       |
|                |              |                          |                        |                    |              |
|                |              |                          |                        |                    |              |
|                |              |                          |                        |                    |              |

[1.引言 4](#_Toc29883)

[1.1标识 4](#标识)

[1.2数据库概述 4](#数据库概述)

[1.3文档概述 4](#文档概述)

[2.引用文件 5](#_Toc20628)

[3.数据库设计决策 5](#_Toc13161)

[3.1数据库管理系统 5](#数据库管理系统)

[3.2数据库分布与数据库文件更新与维护： 5](#数据库分布与数据库文件更新与维护)

[3.3数据库备份与恢复 5](#数据库备份与恢复)

[3.4数据库接收的查询及其输出 6](#数据库接收的查询及其输出)

[3.5查询数据库行为的数据决策 6](#查询数据库行为的数据决策)

[3.6数据文件呈现用户的设计决策 6](#数据文件呈现用户的设计决策)

[3.7数据库的私密性 6](#数据库的私密性)

[4.数据库详细设计 6](#_Toc31776)

[4.1数据库UML类图： 7](#数据库uml类图)

[4.2数据库设计级别 7](#数据库设计级别)

[4.2.1数据库设计中的单个数据元素特性 7](#数据库设计中的单个数据元素特性)

[4.2.2数据库设计中元素集合体的特性 10](#数据库设计中元素集合体的特性)

[5.用于数据库访问或操纵的软件配置项的详细设计 15](#_Toc6487)

[6.需求的可追踪性 16](#_Toc12925)

[7.注解 17](#_Toc11037)

1.**引言**

1.1标识
-------

名 称： H2H数据库系统

版本号： V3.0

缩略词： H2H-Doc-DBDD-V3.0

1.2数据库概述
-------------

| 数据库名称     | H2H数据库              |
|----------------|------------------------|
| 数据库系统     | MySQL 5.6              |
| 数据库宿主环境 | Windows系列            |
| 客户端连接工具 | Navicat for MySQL 10.1 |
| 针对用户       | 校内大学生             |
| 需求方         | 各大高校               |
| 开发方         | H2H小组                |

本文档编写目的是为了说明“H2H软件系统”的数据库设计、结构情况,用于开发人员进行项目设计,同时也为后续的数据库维护工作提供了良好的使用说明,也可以作为未来版本升级时的重要参考资料。

1.3文档概述
-----------

本文档编写目的是明确“H2H软件系统”中各项功能和非功能性需求实现时所需要的数据类型,数据关系,数据流程,并用于指导设计人员对数据库的设计。

《H2H软件系统数据库设计说明书》的阅读对象为:

1.  数据库设计人员

2.  对《数据设计说明书》进行评审和确认的有关业务、技术人员

3.  H2H项目组,其他有权需要调用本文档的人员

2.引用文件

1.   GB/T-8567-2006 计算机软件文档编制规范

2.   GB/T-11457-1995 软件工程术语

3.   GB8566-1995 软件生存期过程

3.数据库设计决策

3.1数据库管理系统
-----------------

| 名称  | 版本      |
|-------|-----------|
| MySQL | MySQL 5.6 |

3.2数据库分布与数据库文件更新与维护：
-------------------------------------

数据库的分布模式采用客户机/服务器模式。因为是采用客户机/服务器模式,所以不存在需要保证数据库的一致性以及数据同步等问题。

3.3数据库备份与恢复
-------------------

数据库备份方式：采用直接转储SQL文件的形式

数据库备份策略：每2天进行1次备份，备份流程为:关闭服务器-\>拷
贝文件-\>重启服务器。

数据库恢复方式：通过备份文件或者更新日志来进行恢复。

3.4数据库接收的查询及其输出
---------------------------

(相关数据集合在以下详细说明)

| 查询     | 输出                     |
|----------|--------------------------|
| 用户信息 | 数据库用户集合体所有信息 |
| 任务信息 | 数据库任务集合体所有信息 |
| 评论信息 | 数据库评论集合体所有信息 |
| 消息信息 | 数据库消息集合体所有信息 |
| 公告信息 | 数据库公告集合体所有信息 |
| 申请信息 | 数据库申请集合体所有信息 |

3.5查询数据库行为的数据决策
---------------------------

查询动作：除登陆需要通过加密传输查询，其余查询均为Web模式明文
传输查询信息，对服务器端数据库进行查询。

响应时间：网络正常，不超过0.5s

其他特性：查询内容以及返回结果均在HTTP报文传递。

3.6数据文件呈现用户的设计决策
-----------------------------

本项目为Web项目，数据将在前端以可视化的形式呈现给用户。

3.7数据库的私密性
-----------------

为保证用户账号安全，数据库存储密码的MD5值。

4.数据库详细设计

4.1数据库UML类图：
------------------

![UML类图](media/46e4ca375f81fdf088cc88f9abcb19aa.jpg)

4.2数据库设计级别
-----------------

### 4.2.1数据库设计中的单个数据元素特性

#### 4.2.1.1名称/标识符

| 标识符          | 名称         |
|-----------------|--------------|
| num             | 学号         |
| password        | 密码         |
| email           | 邮箱         |
| phone           | 联系方式     |
| creditScore     | 信誉值       |
| name            | 姓名         |
| points          | 积分         |
| userState       | 账号状态     |
| releasedTaskNum | 发布任务数   |
| finishedTaskNum | 完成任务数   |
| giveUpTaskNum   | 放弃任务数   |
| lastLoginDate   | 最后登录时间 |
| taskID          | 任务ID       |
| title           | 任务标题     |
| description     | 任务描述     |
| type            | 类型         |
| rewardPoints    | 悬赏分       |
| startTime       | 开始时间     |
| deadLine        | 截止时间     |
| publisherNum    | 发布人学号   |
| receiverNum     | 领取人学号   |
| taskState       | 任务状态     |
| heatValue       | 评论数       |
| commentID       | 评论ID       |
| commentatorNum  | 评论人       |
| content         | 内容         |
| time            | 发表时间     |
| id              | 申请ID       |
| applicantNum    | 申请人学号   |
| adminNum        | 管理员账号   |
| messageID       | 消息ID       |
| senderNum       | 发送人学号   |
| receiverNum     | 接收人学号   |
| messageState    | 消息状态     |
| showState       | 发送状态     |
| noticeID        | 公告ID       |
| point           | 数值         |

#### 4.2.1.2数据类型：

Int类型：creditScore，points，userState，releasedTaskNum，finishedTaskNum，giveUpTaskNum，taskID，rewardPoints，taskState，heatValue，commentID，id，messageID，messageState，noticeID，point

long类型：num，publisherNum，receiverNum，commentatorNum，applicantNum，adminNum，senderNum，receiverNum

varchar类型：password，phone，email，name，lastLoginDate，title，description，type，startTime，deadLine，content，time

#### 4.2.1.3大小写格式：

与4.2.1.1表示大小写格式一致。

#### 4.2.1.4范围以及可能值：

以下列举主要数值的范围：

| 名称         | 含义     | 范围或可能值                                                                              |
|--------------|----------|-------------------------------------------------------------------------------------------|
| creditScore  | 信誉值   | 范围：0到100                                                                              |
| userState    | 账号状态 | 0：未封号，1：已封号 2：已删除                                                            |
| taskState    | 任务状态 | 0:未审核，1：审核未通过，2：审核通过，3：执行中，4：已提交，5：已验收 6：已失效 7：已删除 |
| messageState | 消息状态 | 0:未读，1：已读                                                                           |
| time         | 时间     | 例：2019-03-19 11:23:42 yyyy-mm-dd hh:mm:ss格式                                           |

#### 4.2.1.5准确度与精度

准确度：100%

精度：不保留小数。

#### 4.2.1.6其他约束

数据元素是否可被更新：学号num、taskID、commentID、id、messageID、noticeID无法被更新

业务规则是否适用：是。

#### 4.2.1.7保密性与私密性约束

具有保密性的属性：password

#### 4.2.1.8来源与接收者

来源：用户和系统管理员通过相应的权限对数据库进行操作。

接收者：服务器端接收信息执行对数据库修改。

### 4.2.2数据库设计中元素集合体的特性

#### 4.2.2.1名称/标识符

| 标识符    | 名称     |
|-----------|----------|
| User      | 用户     |
| Task      | 任务     |
| Comment   | 评论     |
| Applicant | 申请     |
| Admin     | 管理员   |
| Message   | 消息     |
| Notice    | 公告     |
| TaskType  | 任务类型 |
| Param     | 参数类型 |

#### 4.2.2.2数据元素集合体中数据元素及其结构

用户：

| User | 学号         | num             |
|------|--------------|-----------------|
|      | 密码         | password        |
|      | 联系方式     | phone           |
|      | 邮箱         | email           |
|      | 信誉值       | creditScore     |
|      | 姓名         | name            |
|      | 积分         | points          |
|      | 账号状态     | userState       |
|      | 发布任务数   | releasedTaskNum |
|      | 完成任务数   | finishedTaskNum |
|      | 放弃任务书   | giveUpTaskNum   |
|      | 最后登录时间 | lastLoginDate   |

任务：

| Task | 任务ID     | taskID       |
|------|------------|--------------|
|      | 任务标题   | title        |
|      | 任务描述   | description  |
|      | 类型       | type         |
|      | 悬赏分     | rewardPoints |
|      | 开始时间   | startTime    |
|      | 截止时间   | deadLine     |
|      | 发布人学号 | publisherNum |
|      | 领取人学号 | receiverNum  |
|      | 状态       | taskState    |
|      | 评论数     | heatValue    |

评论：

| Comment | 评论ID   | commentID      |
|---------|----------|----------------|
|         | 评论人   | commentatorNum |
|         | 内容     | content        |
|         | 任务ID   | taskID         |
|         | 发表时间 | time           |

申请：

| Applicant | ID       | id           |
|-----------|----------|--------------|
|           | 任务编号 | taskID       |
|           | 预约人   | applicantNum |

管理员：

| Admin | 账号 | adminNum |
|-------|------|----------|
|       | 名字 | name     |
|       | 密码 | password |
|       | 邮箱 | email    |

消息：

| Message | 消息ID   | messageID    |
|---------|----------|--------------|
|         | 发送人   | senderNum    |
|         | 接收人   | receiverNum  |
|         | 内容     | content      |
|         | 发送时间 | time         |
|         | 消息状态 | messageState |

公告：

| Notice | 公告ID   | noticeID |
|--------|----------|----------|
|        | 标题     | title    |
|        | 内容     | content  |
|        | 发布时间 | time     |

任务类型：

| TaskType | 任务类型 | type |
|----------|----------|------|


公告：

| Param | 参数ID | id    |
|-------|--------|-------|
|       | 数值   | point |

#### 4.2.2.3媒体及媒体上数据元素集合体的结构

媒体：磁盘

数据集合存储的数据结构：树形结构

#### 4.2.2.4显示和其他输出的视觉特性

显示方式：表格行、下拉框形式，Web前端显示。

#### 4.2.2.5其他约束

数据集合体是否能被更新：是

业务规则是否适用：是

#### 4.2.2.6保密性与私密性

| 非技术字段 | 标识符    | 私密性与保密性 |
|------------|-----------|----------------|
| 用户       | User      | 密码属性保密   |
| 任务       | Task      | 不具有保密性   |
| 评论       | Comment   | 不具有保密性   |
| 申请       | Applicant | 不具有保密性   |
| 管理员     | Admin     | 完全保密       |
| 消息       | Message   | 不具有保密性   |
| 公告       | Notice    | 不具有保密性   |
| 任务类型   | TaskType  | 不具有保密性   |
| 参数类型   | Param     | 不具有保密性   |

#### 4.2.2.7来源与接收者

来源：用户和管理员通过相应的权限对数据库中存储的各个数据结构集合体进行操作。

接收者：服务器端接收信息执行对数据库修改。

5.用于数据库访问或操纵的软件配置项的详细设计

**5.1配置项设计决策使用的算法**

1.join

用于根据两个或多个表中的列之间的关系，从这些表中查询数据。

2.distinct

将表中每一列放入一个hash结构中，最终，这个hash结构中有多少个key，也就是去除重复后的结果。
所以，在当distinct结果集较大时，该方法的内存消耗成为瓶颈。

3.group by

先对col进行排序，排序的事件复杂度为nlogn，空间复杂度为1。

**5.2配置项设计中的约束**

主要约束为结构约束与私密性约束。

**5.3配置项中涉及编程语言**

SQL数据库结构化查询语言

**5.4接口使用通信方法特性**

通信链路为常见的互联网链路通信，带宽大于等于20M，消息报文格式遵循HTTP传输协议，数据传输间隔在0.5s以内，数据传输率大约在500KB/s。在本机运行服务器端为localhost:8888，

采用Tomcat软件建立服务器。

**5.5接口使用协议特性**

基于Web项目，通信协议HTTP。

6.需求的可追踪性

1.  从本DBDD所提到的每个数据库或其他软件配置项到它们所涉及的系统或CSCI需求的可追踪性。

2.  从已经分配给本DBDD所提及的数据库或软件配置项的每个系统或CSCI需求到涉及它们的数据库或软件配置项的可追踪性。

7.注解

JDK:  JDK(Java Development Kit)是Sun Microsystems针对Java开发员的产品。自从Java推出以来,JDK已经成为使用最广泛的Java SDK。JDK 是整个Java的核心,包括了Java运行环境、Java工具和Java基础类库。JDK是学好Java的第一步。而专门运行在x86平台的Jrocket在服务端运行效率也要比Sun JDK好很多。从SUN的JDK5.0开始,提供了泛型等非常实用的功能,其版本也不断更新,运行效率得到了非常大的提高。

MySQL:  MySQL 是一个关系型数据库管理系统,由瑞典 MySQL AB 公司开发,目前属于 Oracle 旗下公司。MySQL 最流行的关系型数据库管理系统,在WEB 应用方面 MySQL 是最好的RDBMS (Relational Database Management System,关系数据库管理系统) 应用软件之一。MySQL 是一种关联数据库管理系统,关联数据库将数据保存在不同的表中,而不是将所有数据放在一个大仓库内,这样就增加了速度并提高了灵活性。MySQL 所使用的 SQL 语言是用于访问数据库的最常用标准化语言。MySQL 软件采用了双授权政策(本词条“授权政策”)，它分为社区版和商业版,由于其体积小、速度快、总体拥有成本低,尤其是开放源码这一特点,一般中小型网站的开发都选择 MySQL 作为网站数据库。由于其社区版的性能卓越,搭配 PHP 和 Apache 可组成良好的开发环境。

CSCI：计算机软件配置项
